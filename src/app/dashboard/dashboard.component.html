<div class="container"> 
  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <h2>Loading your collection...</h2>
    <div class="loading-spinner"></div>
  </div>

  <!-- Main Dashboard Content -->
  <div *ngIf="!loading" class="dashboard-content">
    
    <!-- Pack Suggestions -->
    <div class="pack-suggestions" *ngIf="packSuggestions.length > 0">
      <details open>
        <summary>üéÅ Pack Opening Suggestions</summary>
        <p class="suggestion-subtitle">Optimized recommendations based on your missing cards</p>
        <div class="suggestions-list">
          <div *ngFor="let suggestion of packSuggestions; let i = index" class="suggestion-item" [class.top-pick]="i === 0">
            <div class="suggestion-header">
              <span class="rank-number">#{{ i + 1 }}</span>
              <span *ngIf="i === 0" class="top-pick-badge">üèÜ TOP PICK</span>
              <strong>{{ suggestion.packName }}</strong>
            </div>
            <div class="suggestion-summary">
              <span class="missing-count">{{ suggestion.missingCards }} missing cards</span>
              <span class="completion-rate">{{ suggestion.completionPercentage }}% complete</span>
              <span class="progress-count">({{ suggestion.ownedCards }}/{{ suggestion.totalCards }})</span>
            </div>
          </div>
        </div>
      </details>
    </div>

    <!-- Set Progress -->
    <div class="set-progress" *ngIf="setProgress.length > 0">
      <details open>
        <summary>üì¶ Set Completion Progress</summary>
        <div class="progress-list">
          <div *ngFor="let set of setProgress" class="progress-item">
            <div class="progress-header">
              <h4>[{{ set.code }}] - {{ set.name }}</h4>
              <span class="progress-percentage">{{ set.percentage }}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="set.percentage"></div>
            </div>
            <p class="progress-details">{{ set.owned }}/{{ set.total }} cards</p>
            
            <!-- Rarity breakdown for this set -->
            <div class="set-rarity-breakdown" *ngIf="set.rarityBreakdown && set.rarityBreakdown.length > 0">
              <h5>Rarity Progress:</h5>
              <div class="set-rarity-grid">
                <div *ngFor="let rarity of set.rarityBreakdown" class="set-rarity-item">
                  <span class="rarity-name">{{ rarity.name }}</span>
                  <div class="rarity-mini-progress">
                    <div class="rarity-mini-bar">
                      <div class="rarity-mini-fill" [style.width.%]="rarity.percentage"></div>
                    </div>
                    <span class="rarity-mini-text">{{ rarity.owned }}/{{ rarity.total }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </details>
    </div>

    <!-- Rarity Breakdown -->
    <div class="rarity-breakdown" *ngIf="rarityStats.length > 0">
      <details open>
        <summary>‚≠ê Collection by Rarity</summary>
        <div class="rarity-grid">
          <div *ngFor="let rarity of userRarityStats" class="rarity-card">
            <div class="rarity-header">
              <h4>{{ rarity.name }}</h4>
              <span class="rarity-count">{{ rarity.owned }}/{{ rarity.total }}</span>
            </div>
            <div class="rarity-progress">
              <div class="rarity-bar">
                <div class="rarity-fill" [style.width.%]="rarity.percentage"></div>
              </div>
              <span class="percentage">{{ rarity.percentage }}%</span>
            </div>
          </div>
        </div>
      </details>
    </div>
  </div>
</div>